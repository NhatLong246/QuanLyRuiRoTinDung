@{
    ViewData["Title"] = "Qu·∫£n l√Ω kho·∫£n vay";
    Layout = "_DashboardLayout";
    var activeLoans = ViewBag.ActiveLoans as List<QuanLyRuiRoTinDung.Models.Entities.KhoanVay> ?? new List<QuanLyRuiRoTinDung.Models.Entities.KhoanVay>();
    var customerInfoDict = ViewBag.CustomerInfoDict as Dictionary<int, (string TenKhachHang, string LoaiKhachHang, string? MaKhachHangCode, string? AnhDaiDien)> ?? new Dictionary<int, (string, string, string?, string?)>();
    var currentTrangThai = ViewBag.CurrentTrangThai as string ?? "all";
    var searchTerm = ViewBag.SearchTerm as string ?? "";
    
    // T√≠nh to√°n th·ªëng k√™
    var totalLoans = activeLoans.Count;
    var dangVay = activeLoans.Count(l => l.TrangThaiKhoanVay == "ƒêang vay");
    var quaHan = activeLoans.Count(l => l.TrangThaiKhoanVay == "Qu√° h·∫°n");
    var daThanhToan = activeLoans.Count(l => l.TrangThaiKhoanVay == "ƒê√£ thanh to√°n");
    var tongTienVay = activeLoans.Sum(l => l.SoTienVay);
}

<div class="loan-manage-container">
    <!-- Page Header -->
    <div class="page-header-section">
        <div class="header-content">
            <div class="header-icon">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <rect x="2" y="3" width="20" height="14" rx="2" ry="2"/>
                    <path d="M2 10h20"/>
                </svg>
            </div>
            <div class="header-text">
                <h1>Qu·∫£n l√Ω kho·∫£n vay</h1>
                <p>Theo d√µi v√† qu·∫£n l√Ω c√°c kho·∫£n vay ƒë√£ ƒë∆∞·ª£c ph√™ duy·ªát</p>
            </div>
        </div>
        <div class="header-actions">
            <button class="btn-export" onclick="exportData()">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M21 15V19C21 19.5304 20.7893 20.0391 20.4142 20.4142C20.0391 20.7893 19.5304 21 19 21H5C4.46957 21 3.96086 20.7893 3.58579 20.4142C3.21071 20.0391 3 19.5304 3 19V15"/>
                    <polyline points="7 10 12 15 17 10"/>
                    <line x1="12" y1="15" x2="12" y2="3"/>
                </svg>
                Xu·∫•t b√°o c√°o
            </button>
        </div>
    </div>

    <!-- Statistics Cards -->
    <div class="stats-grid">
        <div class="stat-card stat-total">
            <div class="stat-icon">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M14 2H6C5.46957 2 4.96086 2.21071 4.58579 2.58579C4.21071 2.96086 4 3.46957 4 4V20C4 20.5304 4.21071 21.0391 4.58579 21.4142C4.96086 21.7893 5.46957 22 6 22H18C18.5304 22 19.0391 21.7893 19.4142 21.4142C19.7893 21.0391 20 20.5304 20 20V8L14 2Z"/>
                    <path d="M14 2V8H20"/>
                    <line x1="16" y1="13" x2="8" y2="13"/>
                    <line x1="16" y1="17" x2="8" y2="17"/>
                </svg>
            </div>
            <div class="stat-content">
                <span class="stat-number">@totalLoans</span>
                <span class="stat-label">T·ªïng kho·∫£n vay</span>
            </div>
        </div>

        <div class="stat-card stat-active">
            <div class="stat-icon">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <circle cx="12" cy="12" r="10"/>
                    <polyline points="12 6 12 12 16 14"/>
                </svg>
            </div>
            <div class="stat-content">
                <span class="stat-number">@dangVay</span>
                <span class="stat-label">ƒêang vay</span>
            </div>
        </div>

        <div class="stat-card stat-overdue">
            <div class="stat-icon">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M10.29 3.86L1.82 18C1.64 18.3 1.55 18.64 1.55 19C1.55 19.36 1.64 19.7 1.82 20C2 20.3 2.25 20.55 2.55 20.73C2.85 20.91 3.19 21 3.55 21H20.47C20.83 21 21.17 20.91 21.47 20.73C21.77 20.55 22.02 20.3 22.2 20C22.38 19.7 22.47 19.36 22.47 19C22.47 18.64 22.38 18.3 22.2 18L13.73 3.86C13.55 3.56 13.3 3.32 13 3.15C12.7 2.98 12.36 2.89 12.01 2.89C11.66 2.89 11.32 2.98 11.02 3.15C10.72 3.32 10.47 3.56 10.29 3.86Z"/>
                    <line x1="12" y1="9" x2="12" y2="13"/>
                    <line x1="12" y1="17" x2="12.01" y2="17"/>
                </svg>
            </div>
            <div class="stat-content">
                <span class="stat-number">@quaHan</span>
                <span class="stat-label">Qu√° h·∫°n</span>
            </div>
        </div>

        <div class="stat-card stat-money">
            <div class="stat-icon">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <line x1="12" y1="1" x2="12" y2="23"/>
                    <path d="M17 5H9.5C8.57174 5 7.6815 5.36875 7.02513 6.02513C6.36875 6.6815 6 7.57174 6 8.5C6 9.42826 6.36875 10.3185 7.02513 10.9749C7.6815 11.6313 8.57174 12 9.5 12H14.5C15.4283 12 16.3185 12.3687 16.9749 13.0251C17.6313 13.6815 18 14.5717 18 15.5C18 16.4283 17.6313 17.3185 16.9749 17.9749C16.3185 18.6313 15.4283 19 14.5 19H6"/>
                </svg>
            </div>
            <div class="stat-content">
                <span class="stat-number">@(tongTienVay >= 1000000000 ? $"{(tongTienVay/1000000000):N1}B" : $"{(tongTienVay/1000000):N0}M")</span>
                <span class="stat-label">T·ªïng d∆∞ n·ª£</span>
            </div>
        </div>
    </div>

    <!-- Filter Section -->
    <div class="filter-section">
        <form method="get" class="filter-form">
            <div class="filter-tabs">
                <a href="?trangThai=all" class="filter-tab @(currentTrangThai == "all" ? "active" : "")">
                    <span class="tab-icon">üìã</span>
                    T·∫•t c·∫£
                    <span class="tab-count">@totalLoans</span>
                </a>
                <a href="?trangThai=ƒêang vay" class="filter-tab @(currentTrangThai == "ƒêang vay" ? "active" : "")">
                    <span class="tab-icon">‚è≥</span>
                    ƒêang vay
                    <span class="tab-count">@dangVay</span>
                </a>
                <a href="?trangThai=Qu√° h·∫°n" class="filter-tab tab-danger @(currentTrangThai == "Qu√° h·∫°n" ? "active" : "")">
                    <span class="tab-icon">‚ö†Ô∏è</span>
                    Qu√° h·∫°n
                    <span class="tab-count">@quaHan</span>
                </a>
                <a href="?trangThai=ƒê√£ thanh to√°n" class="filter-tab @(currentTrangThai == "ƒê√£ thanh to√°n" ? "active" : "")">
                    <span class="tab-icon">‚úÖ</span>
                    ƒê√£ thanh to√°n
                    <span class="tab-count">@daThanhToan</span>
                </a>
            </div>
            <div class="search-box">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <circle cx="11" cy="11" r="8"/>
                    <path d="M21 21L16.65 16.65"/>
                </svg>
                <input type="text" name="searchTerm" value="@searchTerm" placeholder="T√¨m ki·∫øm m√£ kho·∫£n vay, t√™n kh√°ch h√†ng..." />
                <input type="hidden" name="trangThai" value="@currentTrangThai" />
                <button type="submit" class="search-submit">T√¨m</button>
            </div>
        </form>
    </div>

    <!-- Loans Table -->
    <div class="table-wrapper">
        <table class="loans-table">
            <thead>
                <tr>
                    <th class="col-code">
                        <div class="th-content">
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M4 4h16v16H4z"/>
                                <path d="M9 9h6"/>
                                <path d="M9 15h6"/>
                            </svg>
                            M√£ kho·∫£n vay
                        </div>
                    </th>
                    <th class="col-customer">Kh√°ch h√†ng</th>
                    <th class="col-amount">S·ªë ti·ªÅn vay</th>
                    <th class="col-rate">L√£i su·∫•t</th>
                    <th class="col-term">K·ª≥ h·∫°n</th>
                    <th class="col-date">Ng√†y gi·∫£i ng√¢n</th>
                    <th class="col-date">Ng√†y ƒë√°o h·∫°n</th>
                    <th class="col-status">Tr·∫°ng th√°i</th>
                    <th class="col-action">Thao t√°c</th>
                </tr>
            </thead>
            <tbody>
                @if (activeLoans.Any())
                {
                    foreach (var loan in activeLoans)
                    {
                        var customerInfo = customerInfoDict.ContainsKey(loan.MaKhoanVay) ? customerInfoDict[loan.MaKhoanVay] : ("N/A", "CaNhan", null, null);
                        var statusClass = loan.TrangThaiKhoanVay switch
                        {
                            "ƒê√£ duy·ªát" => "badge-approved",
                            "ƒêang vay" => "badge-active",
                            "Qu√° h·∫°n" => "badge-overdue",
                            "ƒê√£ thanh to√°n" => "badge-completed",
                            _ => "badge-default"
                        };
                        var statusIcon = loan.TrangThaiKhoanVay switch
                        {
                            "ƒê√£ duy·ªát" => "‚úì",
                            "ƒêang vay" => "‚óâ",
                            "Qu√° h·∫°n" => "‚ö†",
                            "ƒê√£ thanh to√°n" => "‚úî",
                            _ => "‚Ä¢"
                        };
                        
                        <tr class="loan-row">
                            <td>
                                <a href="@Url.Action("Details", "Loan", new { id = loan.MaKhoanVay })" class="loan-code-link">
                                    <span class="code-hash">#</span>@loan.MaKhoanVayCode
                                </a>
                            </td>
                            <td>
                                <div class="customer-cell">
                                    <div class="avatar @(customerInfo.LoaiKhachHang == "CaNhan" ? "avatar-personal" : "avatar-business")">
                                        @if (!string.IsNullOrEmpty(customerInfo.Item4))
                                        {
                                            <img src="@customerInfo.Item4" alt="Avatar" />
                                        }
                                        else
                                        {
                                            @(customerInfo.LoaiKhachHang == "CaNhan" ? "üë§" : "üè¢")
                                        }
                                    </div>
                                    <div class="customer-info">
                                        <span class="customer-name">@customerInfo.TenKhachHang</span>
                                        <span class="customer-type-badge @(customerInfo.LoaiKhachHang == "CaNhan" ? "type-personal" : "type-business")">
                                            @(customerInfo.LoaiKhachHang == "CaNhan" ? "C√° nh√¢n" : "Doanh nghi·ªáp")
                                        </span>
                                    </div>
                                </div>
                            </td>
                            <td>
                                <div class="amount-cell">
                                    <span class="amount-value">@loan.SoTienVay.ToString("N0")</span>
                                    <span class="amount-currency">VNƒê</span>
                                </div>
                            </td>
                            <td>
                                <span class="rate-badge">@($"{loan.LaiSuat:N1}%")/nƒÉm</span>
                            </td>
                            <td>
                                <span class="term-value">@loan.KyHanVay <small>th√°ng</small></span>
                            </td>
                            <td>
                                <div class="date-cell">
                                    @if (loan.NgayGiaiNgan.HasValue)
                                    {
                                        <span class="date-value">@loan.NgayGiaiNgan.Value.ToString("dd/MM/yyyy")</span>
                                    }
                                    else
                                    {
                                        <span class="date-pending">Ch·ªù gi·∫£i ng√¢n</span>
                                    }
                                </div>
                            </td>
                            <td>
                                <div class="date-cell">
                                    @if (loan.NgayDaoHan.HasValue)
                                    {
                                        var daysLeft = (loan.NgayDaoHan.Value.ToDateTime(TimeOnly.MinValue) - DateTime.Now).Days;
                                        <span class="date-value">@loan.NgayDaoHan.Value.ToString("dd/MM/yyyy")</span>
                                        @if (daysLeft > 0 && daysLeft <= 30 && loan.TrangThaiKhoanVay == "ƒêang vay")
                                        {
                                            <span class="days-left warning">C√≤n @daysLeft ng√†y</span>
                                        }
                                        else if (daysLeft < 0 && loan.TrangThaiKhoanVay != "ƒê√£ thanh to√°n")
                                        {
                                            <span class="days-left danger">Qu√° @(-daysLeft) ng√†y</span>
                                        }
                                    }
                                    else
                                    {
                                        <span class="date-pending">--</span>
                                    }
                                </div>
                            </td>
                            <td>
                                <span class="status-badge @statusClass">
                                    <span class="status-icon">@statusIcon</span>
                                    @loan.TrangThaiKhoanVay
                                </span>
                            </td>
                            <td>
                                <div class="action-buttons">
                                    <a href="@Url.Action("Details", "Loan", new { id = loan.MaKhoanVay })" class="action-btn view-btn" title="Xem chi ti·∫øt">
                                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                            <path d="M1 12S5 4 12 4 23 12 23 12 19 20 12 20 1 12 1 12Z"/>
                                            <circle cx="12" cy="12" r="3"/>
                                        </svg>
                                    </a>
                                    @if (loan.TrangThaiKhoanVay == "ƒêang vay")
                                    {
                                        <button class="action-btn payment-btn" title="Ghi nh·∫≠n thanh to√°n" onclick="recordPayment(@loan.MaKhoanVay)">
                                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                                <rect x="1" y="4" width="22" height="16" rx="2" ry="2"/>
                                                <line x1="1" y1="10" x2="23" y2="10"/>
                                            </svg>
                                        </button>
                                    }
                                </div>
                            </td>
                        </tr>
                    }
                }
                else
                {
                    <tr>
                        <td colspan="9">
                            <div class="empty-state">
                                <div class="empty-icon">
                                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                                        <path d="M19 21H5C4.46957 21 3.96086 20.7893 3.58579 20.4142C3.21071 20.0391 3 19.5304 3 19V5C3 4.46957 3.21071 3.96086 3.58579 3.58579C3.96086 3.21071 4.46957 3 5 3H15L21 9V19C21 19.5304 20.7893 20.0391 20.4142 20.4142C20.0391 20.7893 19.5304 21 19 21Z"/>
                                        <path d="M15 3V9H21"/>
                                        <path d="M9 13H15"/>
                                        <path d="M9 17H12"/>
                                    </svg>
                                </div>
                                <h3>Ch∆∞a c√≥ kho·∫£n vay n√†o</h3>
                                <p>C√°c kho·∫£n vay ƒë√£ ƒë∆∞·ª£c ph√™ duy·ªát s·∫Ω hi·ªÉn th·ªã ·ªü ƒë√¢y</p>
                            </div>
                        </td>
                    </tr>
                }
            </tbody>
        </table>
    </div>
</div>

<style>
    .loan-manage-container {
        padding: 0;
        min-height: 100vh;
    }

    /* Page Header */
    .page-header-section {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 28px;
        padding-bottom: 20px;
        border-bottom: 1px solid #e5e7eb;
    }

    .header-content {
        display: flex;
        align-items: center;
        gap: 16px;
    }

    .header-icon {
        width: 56px;
        height: 56px;
        background: linear-gradient(135deg, #3b82f6 0%, #1d4ed8 100%);
        border-radius: 14px;
        display: flex;
        align-items: center;
        justify-content: center;
        box-shadow: 0 4px 14px rgba(59, 130, 246, 0.35);
    }

    .header-icon svg {
        width: 28px;
        height: 28px;
        color: white;
    }

    .header-text h1 {
        font-size: 26px;
        font-weight: 700;
        color: #1e293b;
        margin: 0 0 4px 0;
    }

    .header-text p {
        font-size: 14px;
        color: #64748b;
        margin: 0;
    }

    .btn-export {
        display: flex;
        align-items: center;
        gap: 8px;
        padding: 10px 20px;
        background: #f8fafc;
        border: 1px solid #e2e8f0;
        border-radius: 10px;
        font-size: 14px;
        font-weight: 500;
        color: #475569;
        cursor: pointer;
        transition: all 0.2s;
    }

    .btn-export:hover {
        background: #f1f5f9;
        border-color: #cbd5e1;
    }

    .btn-export svg {
        width: 18px;
        height: 18px;
    }

    /* Statistics Cards */
    .stats-grid {
        display: grid;
        grid-template-columns: repeat(4, 1fr);
        gap: 20px;
        margin-bottom: 28px;
    }

    .stat-card {
        background: white;
        border-radius: 16px;
        padding: 20px 24px;
        display: flex;
        align-items: center;
        gap: 16px;
        box-shadow: 0 1px 3px rgba(0,0,0,0.08);
        border: 1px solid #f1f5f9;
        transition: all 0.3s ease;
    }

    .stat-card:hover {
        transform: translateY(-2px);
        box-shadow: 0 8px 25px rgba(0,0,0,0.1);
    }

    .stat-icon {
        width: 52px;
        height: 52px;
        border-radius: 12px;
        display: flex;
        align-items: center;
        justify-content: center;
    }

    .stat-icon svg {
        width: 26px;
        height: 26px;
    }

    .stat-total .stat-icon {
        background: linear-gradient(135deg, #e0e7ff 0%, #c7d2fe 100%);
        color: #4f46e5;
    }

    .stat-active .stat-icon {
        background: linear-gradient(135deg, #dbeafe 0%, #bfdbfe 100%);
        color: #2563eb;
    }

    .stat-overdue .stat-icon {
        background: linear-gradient(135deg, #fee2e2 0%, #fecaca 100%);
        color: #dc2626;
    }

    .stat-money .stat-icon {
        background: linear-gradient(135deg, #d1fae5 0%, #a7f3d0 100%);
        color: #059669;
    }

    .stat-content {
        display: flex;
        flex-direction: column;
    }

    .stat-number {
        font-size: 28px;
        font-weight: 700;
        color: #1e293b;
        line-height: 1.2;
    }

    .stat-label {
        font-size: 13px;
        color: #64748b;
        margin-top: 2px;
    }

    /* Filter Section */
    .filter-section {
        background: white;
        border-radius: 16px;
        padding: 6px;
        margin-bottom: 24px;
        box-shadow: 0 1px 3px rgba(0,0,0,0.08);
        border: 1px solid #f1f5f9;
    }

    .filter-form {
        display: flex;
        align-items: center;
        justify-content: space-between;
        gap: 16px;
    }

    .filter-tabs {
        display: flex;
        gap: 4px;
    }

    .filter-tab {
        display: flex;
        align-items: center;
        gap: 8px;
        padding: 12px 18px;
        border-radius: 10px;
        font-size: 14px;
        font-weight: 500;
        color: #64748b;
        text-decoration: none;
        transition: all 0.2s;
    }

    .filter-tab:hover {
        background: #f8fafc;
        color: #3b82f6;
    }

    .filter-tab.active {
        background: #3b82f6;
        color: white;
    }

    .filter-tab.tab-danger.active {
        background: #ef4444;
    }

    .tab-icon {
        font-size: 16px;
    }

    .tab-count {
        background: rgba(0,0,0,0.1);
        padding: 2px 8px;
        border-radius: 20px;
        font-size: 12px;
        font-weight: 600;
    }

    .filter-tab.active .tab-count {
        background: rgba(255,255,255,0.25);
    }

    .search-box {
        display: flex;
        align-items: center;
        background: #f8fafc;
        border: 1px solid #e2e8f0;
        border-radius: 10px;
        padding: 4px 4px 4px 14px;
        min-width: 320px;
    }

    .search-box svg {
        width: 18px;
        height: 18px;
        color: #94a3b8;
        flex-shrink: 0;
    }

    .search-box input {
        flex: 1;
        border: none;
        background: transparent;
        padding: 8px 12px;
        font-size: 14px;
        outline: none;
    }

    .search-box input::placeholder {
        color: #94a3b8;
    }

    .search-submit {
        padding: 8px 16px;
        background: #3b82f6;
        color: white;
        border: none;
        border-radius: 8px;
        font-size: 13px;
        font-weight: 500;
        cursor: pointer;
        transition: background 0.2s;
    }

    .search-submit:hover {
        background: #2563eb;
    }

    /* Table Styles */
    .table-wrapper {
        background: white;
        border-radius: 16px;
        overflow: hidden;
        box-shadow: 0 1px 3px rgba(0,0,0,0.08);
        border: 1px solid #f1f5f9;
    }

    .loans-table {
        width: 100%;
        border-collapse: collapse;
    }

    .loans-table thead {
        background: #f8fafc;
    }

    .loans-table th {
        padding: 16px 18px;
        text-align: left;
        font-size: 12px;
        font-weight: 600;
        text-transform: uppercase;
        color: #64748b;
        letter-spacing: 0.5px;
        border-bottom: 1px solid #e2e8f0;
    }

    .th-content {
        display: flex;
        align-items: center;
        gap: 8px;
    }

    .th-content svg {
        width: 16px;
        height: 16px;
        opacity: 0.5;
    }

    .loans-table td {
        padding: 18px;
        border-bottom: 1px solid #f1f5f9;
        vertical-align: middle;
    }

    .loan-row {
        transition: background 0.15s;
    }

    .loan-row:hover {
        background: #fafbfc;
    }

    .loan-row:last-child td {
        border-bottom: none;
    }

    /* Loan Code */
    .loan-code-link {
        display: inline-flex;
        align-items: center;
        font-size: 14px;
        font-weight: 600;
        color: #3b82f6;
        text-decoration: none;
        padding: 6px 12px;
        background: #eff6ff;
        border-radius: 8px;
        transition: all 0.2s;
    }

    .loan-code-link:hover {
        background: #dbeafe;
        color: #2563eb;
    }

    .code-hash {
        color: #93c5fd;
        margin-right: 1px;
    }

    /* Customer Cell */
    .customer-cell {
        display: flex;
        align-items: center;
        gap: 12px;
    }

    .avatar {
        width: 42px;
        height: 42px;
        border-radius: 10px;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 18px;
        overflow: hidden;
    }

    .avatar img {
        width: 100%;
        height: 100%;
        object-fit: cover;
    }

    .avatar-personal {
        background: linear-gradient(135deg, #e0e7ff 0%, #c7d2fe 100%);
    }

    .avatar-business {
        background: linear-gradient(135deg, #fef3c7 0%, #fde68a 100%);
    }

    .customer-info {
        display: flex;
        flex-direction: column;
        gap: 4px;
    }

    .customer-name {
        font-weight: 500;
        color: #1e293b;
        font-size: 14px;
    }

    .customer-type-badge {
        display: inline-flex;
        align-items: center;
        font-size: 11px;
        padding: 2px 8px;
        border-radius: 4px;
        font-weight: 500;
        width: fit-content;
    }

    .type-personal {
        background: #ede9fe;
        color: #7c3aed;
    }

    .type-business {
        background: #fef3c7;
        color: #b45309;
    }

    /* Amount Cell */
    .amount-cell {
        display: flex;
        flex-direction: column;
    }

    .amount-value {
        font-weight: 700;
        color: #1e293b;
        font-size: 15px;
    }

    .amount-currency {
        font-size: 11px;
        color: #94a3b8;
        font-weight: 500;
    }

    /* Rate Badge */
    .rate-badge {
        display: inline-flex;
        padding: 4px 10px;
        background: #f0fdf4;
        color: #16a34a;
        border-radius: 6px;
        font-size: 13px;
        font-weight: 500;
    }

    /* Term Value */
    .term-value {
        font-weight: 500;
        color: #475569;
    }

    .term-value small {
        color: #94a3b8;
        font-weight: 400;
    }

    /* Date Cell */
    .date-cell {
        display: flex;
        flex-direction: column;
        gap: 2px;
    }

    .date-value {
        font-size: 14px;
        color: #475569;
    }

    .date-pending {
        color: #94a3b8;
        font-style: italic;
        font-size: 13px;
    }

    .days-left {
        font-size: 11px;
        font-weight: 500;
        padding: 2px 6px;
        border-radius: 4px;
        width: fit-content;
    }

    .days-left.warning {
        background: #fef3c7;
        color: #b45309;
    }

    .days-left.danger {
        background: #fee2e2;
        color: #dc2626;
    }

    /* Status Badge */
    .status-badge {
        display: inline-flex;
        align-items: center;
        gap: 6px;
        padding: 6px 12px;
        border-radius: 20px;
        font-size: 12px;
        font-weight: 600;
    }

    .status-icon {
        font-size: 10px;
    }

    .badge-approved {
        background: #d1fae5;
        color: #059669;
    }

    .badge-active {
        background: #dbeafe;
        color: #2563eb;
    }

    .badge-overdue {
        background: #fee2e2;
        color: #dc2626;
    }

    .badge-completed {
        background: #f1f5f9;
        color: #64748b;
    }

    .badge-default {
        background: #f3f4f6;
        color: #6b7280;
    }

    /* Action Buttons */
    .action-buttons {
        display: flex;
        gap: 8px;
    }

    .action-btn {
        width: 36px;
        height: 36px;
        border: none;
        border-radius: 8px;
        display: flex;
        align-items: center;
        justify-content: center;
        cursor: pointer;
        transition: all 0.2s;
        text-decoration: none;
    }

    .action-btn svg {
        width: 18px;
        height: 18px;
    }

    .view-btn {
        background: #f1f5f9;
        color: #64748b;
    }

    .view-btn:hover {
        background: #3b82f6;
        color: white;
    }

    .payment-btn {
        background: #f0fdf4;
        color: #16a34a;
    }

    .payment-btn:hover {
        background: #16a34a;
        color: white;
    }

    /* Empty State */
    .empty-state {
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        padding: 80px 40px;
        text-align: center;
    }

    .empty-icon {
        width: 80px;
        height: 80px;
        background: #f8fafc;
        border-radius: 20px;
        display: flex;
        align-items: center;
        justify-content: center;
        margin-bottom: 20px;
    }

    .empty-icon svg {
        width: 40px;
        height: 40px;
        color: #cbd5e1;
    }

    .empty-state h3 {
        font-size: 18px;
        font-weight: 600;
        color: #475569;
        margin: 0 0 8px 0;
    }

    .empty-state p {
        font-size: 14px;
        color: #94a3b8;
        margin: 0;
    }

    /* Responsive */
    @@media (max-width: 1200px) {
        .stats-grid {
            grid-template-columns: repeat(2, 1fr);
        }
    }

    @@media (max-width: 992px) {
        .filter-form {
            flex-direction: column;
            align-items: stretch;
        }

        .filter-tabs {
            overflow-x: auto;
            padding-bottom: 8px;
        }

        .search-box {
            min-width: unset;
        }
    }

    @@media (max-width: 768px) {
        .page-header-section {
            flex-direction: column;
            align-items: flex-start;
            gap: 16px;
        }

        .stats-grid {
            grid-template-columns: 1fr;
        }

        .table-wrapper {
            overflow-x: auto;
        }

        .loans-table {
            min-width: 900px;
        }
    }
</style>

<script>
    function exportData() {
        alert('Ch·ª©c nƒÉng xu·∫•t b√°o c√°o ƒëang ƒë∆∞·ª£c ph√°t tri·ªÉn');
    }

    function recordPayment(loanId) {
        alert('Ch·ª©c nƒÉng ghi nh·∫≠n thanh to√°n cho kho·∫£n vay #' + loanId + ' ƒëang ƒë∆∞·ª£c ph√°t tri·ªÉn');
    }
</script>
