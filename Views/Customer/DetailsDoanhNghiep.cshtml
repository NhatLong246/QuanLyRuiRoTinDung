@model QuanLyRuiRoTinDung.Models.Entities.KhachHangDoanhNghiep
@{
    ViewData["Title"] = "Chi tiết khách hàng doanh nghiệp";
    Layout = "_DashboardLayout";
}

<div class="customer-details">
    <!-- Header -->
    <div class="page-header">
        <div class="header-left">
            <a href="@Url.Action("List", "Customer")" class="back-button" title="Quay lại danh sách">
                <img src="~/asset/image/icons8-back-arrow-80.png" alt="Quay lại" />
            </a>
            <div class="header-content">
                <h1 class="page-title">Chi tiết khách hàng doanh nghiệp</h1>
                <p class="page-subtitle">Mã khách hàng: <strong>@Model.MaKhachHangCode</strong></p>
            </div>
        </div>
        <div class="header-actions">
            <span class="customer-type-badge doanh-nghiep">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M3 9L12 2L21 9V20C21 20.5304 20.7893 21.0391 20.4142 21.4142C20.0391 21.7893 19.5304 22 19 22H5C4.46957 22 3.96086 21.7893 3.58579 21.4142C3.21071 21.0391 3 20.5304 3 20V9Z"></path>
                    <path d="M9 22V12H15V22"></path>
                </svg>
                Doanh nghiệp
            </span>
        </div>
    </div>

    <!-- Main Content -->
    <div class="content-grid">
        <!-- Left Column - Company Info & Credit -->
        <div class="left-column">
            <div class="profile-card">
                <div class="company-icon">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                        <path d="M3 9L12 2L21 9V20C21 20.5304 20.7893 21.0391 20.4142 21.4142C20.0391 21.7893 19.5304 22 19 22H5C4.46957 22 3.96086 21.7893 3.58579 21.4142C3.21071 21.0391 3 20.5304 3 20V9Z"></path>
                        <path d="M9 22V12H15V22"></path>
                    </svg>
                </div>
                <div class="profile-info">
                    <h2 class="customer-name">@Model.TenCongTy</h2>
                    <p class="customer-code">@Model.MaKhachHangCode</p>
                    <p class="tax-code">MST: @Model.MaSoThue</p>
                </div>

                <div class="quick-stats">
                    <div class="stat-item">
                        <span class="stat-label">Điểm tín dụng</span>
                        <span class="stat-value @(Model.DiemTinDung >= 600 ? "good" : Model.DiemTinDung >= 400 ? "medium" : "low")">
                            @(Model.DiemTinDung?.ToString() ?? "Chưa xếp hạng")
                        </span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-label">Xếp hạng</span>
                        <span class="stat-value rating @(Model.XepHangTinDung ?? "")">
                            @(Model.XepHangTinDung ?? "N/A")
                        </span>
                    </div>
                </div>

                @if (Model.TrangThaiHoatDong == true)
                {
                    <span class="status-badge active">
                        <svg viewBox="0 0 24 24" fill="currentColor">
                            <circle cx="12" cy="12" r="8"/>
                        </svg>
                        Đang hoạt động
                    </span>
                }
                else
                {
                    <span class="status-badge inactive">
                        <svg viewBox="0 0 24 24" fill="currentColor">
                            <circle cx="12" cy="12" r="8"/>
                        </svg>
                        Ngừng hoạt động
                    </span>
                }
            </div>

            <!-- Document Images -->
            <div class="card document-card">
                <h3 class="card-title">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
                        <polyline points="14 2 14 8 20 8"></polyline>
                    </svg>
                    Giấy tờ đính kèm
                </h3>
                <div class="document-list">
                    @if (!string.IsNullOrEmpty(Model.AnhGiayPhepKinhDoanh))
                    {
                        <a href="@Model.AnhGiayPhepKinhDoanh" target="_blank" class="document-item">
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
                                <polyline points="14 2 14 8 20 8"></polyline>
                            </svg>
                            Giấy phép kinh doanh
                        </a>
                    }
                    @if (!string.IsNullOrEmpty(Model.AnhBaoCaoTaichinh))
                    {
                        <a href="@Model.AnhBaoCaoTaichinh" target="_blank" class="document-item">
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
                                <polyline points="14 2 14 8 20 8"></polyline>
                            </svg>
                            Báo cáo tài chính
                        </a>
                    }
                    @if (!string.IsNullOrEmpty(Model.AnhGiayToLienQuanKhac))
                    {
                        <a href="@Model.AnhGiayToLienQuanKhac" target="_blank" class="document-item">
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
                                <polyline points="14 2 14 8 20 8"></polyline>
                            </svg>
                            Giấy tờ khác
                        </a>
                    }
                    @if (string.IsNullOrEmpty(Model.AnhGiayPhepKinhDoanh) && 
                         string.IsNullOrEmpty(Model.AnhBaoCaoTaichinh) && 
                         string.IsNullOrEmpty(Model.AnhGiayToLienQuanKhac))
                    {
                        <p class="no-documents">Chưa có giấy tờ đính kèm</p>
                    }
                </div>
            </div>

            <!-- CCCD Images -->
            @if (!string.IsNullOrEmpty(Model.CccdTruoc) || !string.IsNullOrEmpty(Model.CccdSau) || !string.IsNullOrEmpty(Model.AnhNguoiDaiDien))
            {
                <div class="card cccd-card">
                    <h3 class="card-title">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <rect x="3" y="4" width="18" height="16" rx="2" ry="2"></rect>
                            <line x1="7" y1="8" x2="17" y2="8"></line>
                            <line x1="7" y1="12" x2="12" y2="12"></line>
                        </svg>
                        Ảnh CCCD/CMND người đại diện
                    </h3>
                    <div class="cccd-images">
                        @if (!string.IsNullOrEmpty(Model.AnhNguoiDaiDien))
                        {
                            <div class="cccd-image-item">
                                <span class="image-label">Ảnh người đại diện</span>
                                <a href="@Model.AnhNguoiDaiDien" target="_blank">
                                    <img src="@Model.AnhNguoiDaiDien" alt="Ảnh người đại diện" />
                                </a>
                            </div>
                        }
                        @if (!string.IsNullOrEmpty(Model.CccdTruoc))
                        {
                            <div class="cccd-image-item">
                                <span class="image-label">CCCD Mặt trước</span>
                                <a href="@Model.CccdTruoc" target="_blank">
                                    <img src="@Model.CccdTruoc" alt="CCCD Mặt trước" />
                                </a>
                            </div>
                        }
                        @if (!string.IsNullOrEmpty(Model.CccdSau))
                        {
                            <div class="cccd-image-item">
                                <span class="image-label">CCCD Mặt sau</span>
                                <a href="@Model.CccdSau" target="_blank">
                                    <img src="@Model.CccdSau" alt="CCCD Mặt sau" />
                                </a>
                            </div>
                        }
                    </div>
                </div>
            }
        </div>

        <!-- Right Column - Detailed Info -->
        <div class="right-column">
            <!-- Company Information -->
            <div class="card">
                <h3 class="card-title">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M3 9L12 2L21 9V20C21 20.5304 20.7893 21.0391 20.4142 21.4142C20.0391 21.7893 19.5304 22 19 22H5C4.46957 22 3.96086 21.7893 3.58579 21.4142C3.21071 21.0391 3 20.5304 3 20V9Z"></path>
                        <path d="M9 22V12H15V22"></path>
                    </svg>
                    Thông tin doanh nghiệp
                </h3>
                <div class="info-grid">
                    <div class="info-item full-width">
                        <span class="info-label">Tên công ty</span>
                        <span class="info-value highlight">@Model.TenCongTy</span>
                    </div>
                    <div class="info-item">
                        <span class="info-label">Mã số thuế</span>
                        <span class="info-value highlight">@Model.MaSoThue</span>
                    </div>
                    <div class="info-item">
                        <span class="info-label">Số giấy phép KD</span>
                        <span class="info-value">@(Model.SoGiayPhepKinhDoanh ?? "Chưa cập nhật")</span>
                    </div>
                    <div class="info-item">
                        <span class="info-label">Ngày cấp giấy phép</span>
                        <span class="info-value">@(Model.NgayCapGiayPhep?.ToString("dd/MM/yyyy") ?? "Chưa cập nhật")</span>
                    </div>
                    <div class="info-item">
                        <span class="info-label">Ngày đăng ký</span>
                        <span class="info-value">@(Model.NgayDangKy?.ToString("dd/MM/yyyy") ?? "Chưa cập nhật")</span>
                    </div>
                    <div class="info-item full-width">
                        <span class="info-label">Lĩnh vực kinh doanh</span>
                        <span class="info-value">@(Model.LinhVucKinhDoanh ?? "Chưa cập nhật")</span>
                    </div>
                </div>
            </div>

            <!-- Legal Representative Information -->
            <div class="card">
                <h3 class="card-title">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M20 21V19C20 17.9391 19.5786 16.9217 18.8284 16.1716C18.0783 15.4214 17.0609 15 16 15H8C6.93913 15 5.92172 15.4214 5.17157 16.1716C4.42143 16.9217 4 17.9391 4 19V21"></path>
                        <circle cx="12" cy="7" r="4"></circle>
                    </svg>
                    Người đại diện pháp luật
                </h3>
                <div class="info-grid">
                    <div class="info-item">
                        <span class="info-label">Họ và tên</span>
                        <span class="info-value highlight">@(Model.NguoiDaiDienPhapLuat ?? "Chưa cập nhật")</span>
                    </div>
                    <div class="info-item">
                        <span class="info-label">Số CCCD/CMND</span>
                        <span class="info-value">@(Model.SoCccdNguoiDaiDienPhapLuat ?? "Chưa cập nhật")</span>
                    </div>
                    <div class="info-item">
                        <span class="info-label">Ngày sinh</span>
                        <span class="info-value">@(Model.NgaySinh?.ToString("dd/MM/yyyy") ?? "Chưa cập nhật")</span>
                    </div>
                    <div class="info-item">
                        <span class="info-label">Giới tính</span>
                        <span class="info-value">@(Model.GioiTinh ?? "Chưa cập nhật")</span>
                    </div>
                </div>
            </div>

            <!-- Contact Information -->
            <div class="card">
                <h3 class="card-title">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z"></path>
                    </svg>
                    Thông tin liên hệ
                </h3>
                <div class="info-grid">
                    <div class="info-item">
                        <span class="info-label">Số điện thoại</span>
                        <span class="info-value">
                            @if (!string.IsNullOrEmpty(Model.SoDienThoai))
                            {
                                <a href="tel:@Model.SoDienThoai" class="contact-link">@Model.SoDienThoai</a>
                            }
                            else
                            {
                                <span>Chưa cập nhật</span>
                            }
                        </span>
                    </div>
                    <div class="info-item">
                        <span class="info-label">Email</span>
                        <span class="info-value">
                            @if (!string.IsNullOrEmpty(Model.Email))
                            {
                                <a href="mailto:@Model.Email" class="contact-link">@Model.Email</a>
                            }
                            else
                            {
                                <span>Chưa cập nhật</span>
                            }
                        </span>
                    </div>
                    <div class="info-item full-width">
                        <span class="info-label">Địa chỉ trụ sở</span>
                        <span class="info-value">
                            @{
                                var addressParts = new List<string>();
                                if (!string.IsNullOrEmpty(Model.DiaChi)) addressParts.Add(Model.DiaChi);
                                if (!string.IsNullOrEmpty(Model.Phuong)) addressParts.Add(Model.Phuong);
                                if (!string.IsNullOrEmpty(Model.Quan)) addressParts.Add(Model.Quan);
                                if (!string.IsNullOrEmpty(Model.ThanhPho)) addressParts.Add(Model.ThanhPho);
                            }
                            @(addressParts.Any() ? string.Join(", ", addressParts) : "Chưa cập nhật")
                        </span>
                    </div>
                </div>
            </div>

            <!-- Financial Information -->
            <div class="card">
                <h3 class="card-title">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <line x1="12" y1="1" x2="12" y2="23"></line>
                        <path d="M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"></path>
                    </svg>
                    Thông tin tài chính
                </h3>
                <div class="info-grid">
                    <div class="info-item">
                        <span class="info-label">Vốn điều lệ</span>
                        <span class="info-value highlight">
                            @(Model.VonDieuLe?.ToString("N0") ?? "Chưa cập nhật") VNĐ
                        </span>
                    </div>
                    <div class="info-item">
                        <span class="info-label">Doanh thu hàng năm</span>
                        <span class="info-value highlight">
                            @(Model.DoanhThuHangNam?.ToString("N0") ?? "Chưa cập nhật") VNĐ
                        </span>
                    </div>
                    <div class="info-item">
                        <span class="info-label">Tổng tài sản</span>
                        <span class="info-value">
                            @(Model.TongTaiSan?.ToString("N0") ?? "Chưa cập nhật") VNĐ
                        </span>
                    </div>
                    <div class="info-item">
                        <span class="info-label">Số lượng nhân viên</span>
                        <span class="info-value">
                            @(Model.SoLuongNhanVien?.ToString("N0") ?? "Chưa cập nhật") người
                        </span>
                    </div>
                </div>
            </div>

            <!-- System Information -->
            <div class="card system-info">
                <h3 class="card-title">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <circle cx="12" cy="12" r="10"></circle>
                        <line x1="12" y1="16" x2="12" y2="12"></line>
                        <line x1="12" y1="8" x2="12.01" y2="8"></line>
                    </svg>
                    Thông tin hệ thống
                </h3>
                <div class="info-grid">
                    <div class="info-item">
                        <span class="info-label">Ngày tạo</span>
                        <span class="info-value">@(Model.NgayTao?.ToString("dd/MM/yyyy HH:mm") ?? "N/A")</span>
                    </div>
                    <div class="info-item">
                        <span class="info-label">Người tạo</span>
                        <span class="info-value">@(Model.NguoiTaoNavigation?.HoTen ?? "N/A")</span>
                    </div>
                    <div class="info-item">
                        <span class="info-label">Cập nhật lần cuối</span>
                        <span class="info-value">@(Model.NgayCapNhat?.ToString("dd/MM/yyyy HH:mm") ?? "Chưa cập nhật")</span>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<style>
/* Main Container */
.customer-details {
    padding: 1.5rem 2rem;
    max-width: 1400px;
    margin: 0 auto;
}

/* Header */
.page-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 2rem;
    flex-wrap: wrap;
    gap: 1rem;
}

.header-left {
    display: flex;
    align-items: center;
    gap: 1rem;
}

.back-button {
    display: flex;
    align-items: center;
    justify-content: center;
    width: 44px;
    height: 44px;
    border-radius: 10px;
    background: #f3f4f6;
    border: 1px solid #e5e7eb;
    transition: all 0.2s;
    flex-shrink: 0;
}

.back-button:hover {
    background: #e5e7eb;
    transform: translateX(-2px);
}

.back-button img {
    width: 28px;
    height: 28px;
}

.page-title {
    font-size: 1.5rem;
    font-weight: 700;
    color: #1a1a1a;
    margin: 0;
}

.page-subtitle {
    font-size: 0.9rem;
    color: #666;
    margin: 0.25rem 0 0;
}

.customer-type-badge {
    display: inline-flex;
    align-items: center;
    gap: 0.5rem;
    padding: 0.5rem 1rem;
    border-radius: 8px;
    font-weight: 600;
    font-size: 0.9rem;
}

.customer-type-badge.doanh-nghiep {
    background: #d1fae5;
    color: #059669;
}

.customer-type-badge svg {
    width: 18px;
    height: 18px;
}

/* Content Grid */
.content-grid {
    display: grid;
    grid-template-columns: 320px 1fr;
    gap: 1.5rem;
}

/* Profile Card */
.profile-card {
    background: white;
    border-radius: 16px;
    padding: 1.5rem;
    box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
    text-align: center;
}

.company-icon {
    width: 100px;
    height: 100px;
    border-radius: 20px;
    background: linear-gradient(135deg, #10b981 0%, #059669 100%);
    display: flex;
    align-items: center;
    justify-content: center;
    margin: 0 auto 1rem;
    color: white;
}

.company-icon svg {
    width: 50px;
    height: 50px;
}

.profile-info {
    margin-bottom: 1.5rem;
}

.customer-name {
    font-size: 1.15rem;
    font-weight: 600;
    color: #1a1a1a;
    margin: 0 0 0.5rem;
    line-height: 1.4;
}

.customer-code {
    font-family: 'Consolas', monospace;
    font-size: 0.85rem;
    color: #666;
    background: #f3f4f6;
    padding: 0.25rem 0.75rem;
    border-radius: 4px;
    display: inline-block;
    margin-bottom: 0.25rem;
}

.tax-code {
    font-size: 0.85rem;
    color: #059669;
    font-weight: 500;
    margin: 0;
}

.quick-stats {
    display: flex;
    justify-content: center;
    gap: 1.5rem;
    margin-bottom: 1.5rem;
    padding: 1rem 0;
    border-top: 1px solid #e5e7eb;
    border-bottom: 1px solid #e5e7eb;
}

.stat-item {
    display: flex;
    flex-direction: column;
    align-items: center;
}

.stat-label {
    font-size: 0.75rem;
    color: #666;
    margin-bottom: 0.25rem;
}

.stat-value {
    font-size: 1.25rem;
    font-weight: 700;
    color: #1a1a1a;
}

.stat-value.good { color: #10b981; }
.stat-value.medium { color: #f59e0b; }
.stat-value.low { color: #ef4444; }

.stat-value.rating {
    padding: 0.25rem 0.5rem;
    border-radius: 6px;
    font-size: 1rem;
}

.stat-value.rating.A, .stat-value.rating.AA, .stat-value.rating.AAA { background: #d1fae5; color: #059669; }
.stat-value.rating.B, .stat-value.rating.BB, .stat-value.rating.BBB { background: #fef3c7; color: #d97706; }
.stat-value.rating.C, .stat-value.rating.CC, .stat-value.rating.CCC { background: #fecaca; color: #dc2626; }

.status-badge {
    display: inline-flex;
    align-items: center;
    gap: 0.5rem;
    padding: 0.5rem 1rem;
    border-radius: 20px;
    font-size: 0.85rem;
    font-weight: 500;
}

.status-badge svg {
    width: 10px;
    height: 10px;
}

.status-badge.active {
    background: #d1fae5;
    color: #059669;
}

.status-badge.inactive {
    background: #f3f4f6;
    color: #6b7280;
}

/* Document Card */
.document-card {
    margin-top: 1.5rem;
}

.document-list {
    display: flex;
    flex-direction: column;
    gap: 0.5rem;
}

.document-item {
    display: flex;
    align-items: center;
    gap: 0.75rem;
    padding: 0.75rem 1rem;
    background: #f9fafb;
    border-radius: 8px;
    color: #374151;
    text-decoration: none;
    transition: all 0.2s;
    font-size: 0.9rem;
}

.document-item:hover {
    background: #f3f4f6;
    color: #2563eb;
}

.document-item svg {
    width: 18px;
    height: 18px;
    color: #6b7280;
}

.document-item:hover svg {
    color: #2563eb;
}

.no-documents {
    text-align: center;
    color: #9ca3af;
    font-size: 0.9rem;
    padding: 1rem;
}

/* CCCD Card */
.cccd-card {
    margin-top: 1.5rem;
}

.cccd-images {
    display: flex;
    flex-direction: column;
    gap: 1rem;
}

.cccd-image-item {
    display: flex;
    flex-direction: column;
    gap: 0.5rem;
}

.image-label {
    font-size: 0.85rem;
    color: #666;
    font-weight: 500;
}

.cccd-image-item img {
    width: 100%;
    border-radius: 8px;
    border: 1px solid #e5e7eb;
    cursor: pointer;
    transition: transform 0.2s;
}

.cccd-image-item img:hover {
    transform: scale(1.02);
}

/* Cards */
.card {
    background: white;
    border-radius: 16px;
    padding: 1.5rem;
    box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
    margin-bottom: 1.5rem;
}

.card:last-child {
    margin-bottom: 0;
}

.card-title {
    display: flex;
    align-items: center;
    gap: 0.75rem;
    font-size: 1rem;
    font-weight: 600;
    color: #1a1a1a;
    margin: 0 0 1.25rem;
    padding-bottom: 0.75rem;
    border-bottom: 1px solid #f3f4f6;
}

.card-title svg {
    width: 20px;
    height: 20px;
    color: #10b981;
}

/* Info Grid */
.info-grid {
    display: grid;
    grid-template-columns: repeat(2, 1fr);
    gap: 1rem;
}

.info-item {
    display: flex;
    flex-direction: column;
    gap: 0.25rem;
}

.info-item.full-width {
    grid-column: span 2;
}

.info-label {
    font-size: 0.8rem;
    color: #6b7280;
    font-weight: 500;
}

.info-value {
    font-size: 0.95rem;
    color: #1a1a1a;
}

.info-value.highlight {
    color: #059669;
    font-weight: 600;
}

.contact-link {
    color: #2563eb;
    text-decoration: none;
}

.contact-link:hover {
    text-decoration: underline;
}

.system-info {
    background: #f9fafb;
}

/* Responsive */
@@media (max-width: 992px) {
    .content-grid {
        grid-template-columns: 1fr;
    }

    .left-column {
        order: 1;
    }

    .right-column {
        order: 2;
    }
}

@@media (max-width: 768px) {
    .customer-details {
        padding: 1rem;
    }

    .page-header {
        flex-direction: column;
        align-items: flex-start;
    }

    .info-grid {
        grid-template-columns: 1fr;
    }

    .info-item.full-width {
        grid-column: span 1;
    }
}
</style>
